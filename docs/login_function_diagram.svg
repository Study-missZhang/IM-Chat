<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="800" height="700" xmlns="http://www.w3.org/2000/svg">
  <!-- 标题 -->
  <text x="400" y="30" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold">登录模块功能流程图</text>
  
  <!-- 背景矩形 -->
  <rect x="50" y="50" width="700" height="630" fill="#f8f9fa" stroke="#ddd" stroke-width="1" rx="5" ry="5"/>
  
  <!-- 初始化阶段 -->
  <rect x="100" y="70" width="600" height="150" fill="#e3f2fd" stroke="#90caf9" stroke-width="2" rx="5" ry="5"/>
  <text x="400" y="90" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">初始化阶段</text>
  
  <!-- LoginInit构造函数 -->
  <rect x="150" y="110" width="200" height="80" fill="#bbdefb" stroke="#64b5f6" stroke-width="2" rx="5" ry="5"/>
  <text x="250" y="130" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">LoginInit构造函数</text>
  <text x="160" y="150" font-family="Arial" font-size="12">1. 加载FXML资源</text>
  <text x="160" y="170" font-family="Arial" font-size="12">2. 设置窗口属性</text>
  <text x="160" y="185" font-family="Arial" font-size="12">3. 调用obtain()获取控件</text>
  
  <!-- LoginController初始化 -->
  <rect x="450" y="110" width="200" height="80" fill="#bbdefb" stroke="#64b5f6" stroke-width="2" rx="5" ry="5"/>
  <text x="550" y="130" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">LoginController初始化</text>
  <text x="460" y="150" font-family="Arial" font-size="12">1. 调用父类构造函数</text>
  <text x="460" y="170" font-family="Arial" font-size="12">2. 实现initView()方法</text>
  <text x="460" y="185" font-family="Arial" font-size="12">3. 实现initEventDefine()方法</text>
  
  <!-- 视图初始化阶段 -->
  <rect x="100" y="240" width="600" height="120" fill="#e8f5e9" stroke="#a5d6a7" stroke-width="2" rx="5" ry="5"/>
  <text x="400" y="260" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">视图初始化阶段</text>
  
  <!-- initView方法 -->
  <rect x="150" y="280" width="200" height="60" fill="#c8e6c9" stroke="#81c784" stroke-width="2" rx="5" ry="5"/>
  <text x="250" y="300" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">initView()</text>
  <text x="160" y="320" font-family="Arial" font-size="12">创建LoginView实例</text>
  
  <!-- LoginView构造函数 -->
  <rect x="450" y="280" width="200" height="60" fill="#c8e6c9" stroke="#81c784" stroke-width="2" rx="5" ry="5"/>
  <text x="550" y="300" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">LoginView构造函数</text>
  <text x="460" y="320" font-family="Arial" font-size="12">保存loginInit和loginEvent引用</text>
  
  <!-- 事件初始化阶段 -->
  <rect x="100" y="380" width="600" height="150" fill="#fff3e0" stroke="#ffcc80" stroke-width="2" rx="5" ry="5"/>
  <text x="400" y="400" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">事件初始化阶段</text>
  
  <!-- initEventDefine方法 -->
  <rect x="150" y="420" width="200" height="60" fill="#ffe0b2" stroke="#ffb74d" stroke-width="2" rx="5" ry="5"/>
  <text x="250" y="440" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">initEventDefine()</text>
  <text x="160" y="460" font-family="Arial" font-size="12">创建LoginEventDefine实例</text>
  
  <!-- LoginEventDefine构造函数 -->
  <rect x="450" y="420" width="200" height="90" fill="#ffe0b2" stroke="#ffb74d" stroke-width="2" rx="5" ry="5"/>
  <text x="550" y="440" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">LoginEventDefine构造函数</text>
  <text x="460" y="460" font-family="Arial" font-size="12">1. 调用loginInit.move()</text>
  <text x="460" y="475" font-family="Arial" font-size="12">2. 绑定最小化、退出按钮事件</text>
  <text x="460" y="490" font-family="Arial" font-size="12">3. 绑定登录按钮事件</text>
  
  <!-- 登录流程阶段 -->
  <rect x="100" y="550" width="600" height="110" fill="#f3e5f5" stroke="#ce93d8" stroke-width="2" rx="5" ry="5"/>
  <text x="400" y="570" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">登录流程阶段</text>
  
  <!-- 登录事件流程 -->
  <rect x="120" y="590" width="560" height="50" fill="#e1bee7" stroke="#ba68c8" stroke-width="2" rx="5" ry="5"/>
  <text x="400" y="610" font-family="Arial" font-size="12" text-anchor="middle">登录按钮点击 → doEventLogin() → ILoginEvent.doLoginCheck() → ILoginMethod.doLoginSuccess()/doLoginError()</text>
  <text x="400" y="630" font-family="Arial" font-size="12" text-anchor="middle">成功登录后调用close()关闭登录窗口，跳转到聊天窗口</text>
  
  <!-- 连接线 -->
  <!-- 初始化阶段连接 -->
  <line x1="350" y1="150" x2="450" y2="150" stroke="#1976d2" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- 初始化到视图初始化 -->
  <line x1="250" y1="190" x2="250" y2="280" stroke="#388e3c" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="550" y1="190" x2="550" y2="280" stroke="#388e3c" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- 视图初始化连接 -->
  <line x1="350" y1="310" x2="450" y2="310" stroke="#388e3c" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- 视图初始化到事件初始化 -->
  <line x1="250" y1="340" x2="250" y2="420" stroke="#f57c00" stroke-width="2" marker-end="url(#arrow)"/>
  <line x1="550" y1="340" x2="550" y2="420" stroke="#f57c00" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- 事件初始化连接 -->
  <line x1="350" y1="450" x2="450" y2="450" stroke="#f57c00" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- 事件初始化到登录流程 -->
  <line x1="400" y1="510" x2="400" y2="550" stroke="#7b1fa2" stroke-width="2" marker-end="url(#arrow)"/>
  
  <!-- 箭头定义 -->
  <defs>
    <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#333"/>
    </marker>
  </defs>
  
  <!-- 图例 -->
  <rect x="100" y="670" width="20" height="10" fill="#e3f2fd" stroke="#90caf9" stroke-width="1"/>
  <text x="130" y="678" font-family="Arial" font-size="10">初始化阶段</text>
  
  <rect x="220" y="670" width="20" height="10" fill="#e8f5e9" stroke="#a5d6a7" stroke-width="1"/>
  <text x="250" y="678" font-family="Arial" font-size="10">视图初始化阶段</text>
  
  <rect x="360" y="670" width="20" height="10" fill="#fff3e0" stroke="#ffcc80" stroke-width="1"/>
  <text x="390" y="678" font-family="Arial" font-size="10">事件初始化阶段</text>
  
  <rect x="500" y="670" width="20" height="10" fill="#f3e5f5" stroke="#ce93d8" stroke-width="1"/>
  <text x="530" y="678" font-family="Arial" font-size="10">登录流程阶段</text>
</svg>